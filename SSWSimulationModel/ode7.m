% En la siguiente función se resolverá el sistema de ecuaciones
% diferenciales, utilizando el comando ODE45.

function dUdt = ode7(t,U,A,Aw,d,m,g,As,ms,k_factor)
% Ecuaiones 
dUdt = zeros(34,1);
dUdt(1) = U(18);
dUdt(2) = U(19);
dUdt(3) = U(20);
dUdt(4) = U(21);
dUdt(5) = U(22);
dUdt(6) = U(23);
dUdt(7) = U(24);
dUdt(8) = U(25);
dUdt(9) = U(26);
dUdt(10) = U(27);
dUdt(11) = U(28);
dUdt(12) = U(29);
dUdt(13) = U(30);
dUdt(14) = U(31);
dUdt(15) = U(32);
dUdt(16) = U(33);
dUdt(17) = U(34);

dUdt(18) = (1/m)*(-A*(d(1) - U(2) + U(1))^(3/2) + m*g);
         if d(1)- U(2) + U(1)<0
             dUdt(18) = (1/m)*(0 + m*g);
         end
         
dUdt(19) = (1/m)*(A*(d(1) - U(2) + U(1))^(3/2) - A*(d(2) - U(3) + U(2))^(3/2) + m*g);

        if (d(1) - U(2) + U(1)<0) && (d(2) - U(3) + U(2)>0)
        dUdt(19) = (1/m)*(0 - A*(d(2) - U(3) + U(2))^(3/2) + m*g);
        end
        
        if (d(1) - U(2) + U(1)>0) && (d(2) - U(3) + U(2)<0)
        dUdt(19) = (1/m)*(A*(d(1) - U(2) + U(1))^(3/2) - 0 + m*g);
        end
        
        if (d(1) - U(2) + U(1)<0) && (d(2) - U(3) + U(2)<0)
        dUdt(19) = (1/m)*(0 - 0 + m*g);
        end
        
dUdt(20) = (1/m)*(A*(d(2) - U(3) + U(2))^(3/2) - A*(d(3) - U(4) + U(3))^(3/2) + m*g);

        if (d(2) - U(3) + U(2)<0) && (d(3) - U(4) + U(3)>0)
        dUdt(20) = (1/m)*(0 - A*(d(3) - U(4) + U(3))^(3/2) + m*g); 
        end
        
        if (d(2) - U(3) + U(2)>0) && (d(3) - U(4) + U(3)<0)
        dUdt(20) = (1/m)*(A*(d(2) - U(3) + U(2))^(3/2) - 0 + m*g);
        end
        
        if (d(2) - U(3) + U(2)<0) && (d(3) - U(4) + U(3)<0)
        dUdt(20) = (1/m)*(0 - 0 + m*g);
        end
   
dUdt(21) = (1/m)*(A*(d(3) - U(4) + U(3))^(3/2) - A*(d(4) - U(5) + U(4))^(3/2) + m*g);

       if (d(3) - U(4) + U(3)<0) && (d(4) - U(5) + U(4)>0)
           dUdt(21) = (1/m)*(0 - A*(d(4) - U(5) + U(4))^(3/2) + m*g);
       end
       if (d(3) - U(4) + U(3)>0) && (d(4) - U(5) + U(4)<0)
       dUdt(21) = (1/m)*(A*(d(3) - U(4) + U(3))^(3/2) - 0 + m*g);
       end
       if (d(3) - U(4) + U(3)<0) && (d(4) - U(5) + U(4)<0)
       dUdt(21) = (1/m)*(0 - 0 + m*g);
       end

dUdt(22) = (1/m)*(A*(d(4) - U(5) + U(4))^(3/2) - A*(d(5) - U(6) + U(5))^(3/2) + m*g);

       if (d(4) - U(5) + U(4)<0) && (d(5) - U(6) + U(5)>0)
       dUdt(22) = (1/m)*(0 - A*(d(5) - U(6) + U(5))^(3/2) + m*g);
       end
       if (d(4) - U(5) + U(4)>0) && (d(5) - U(6) + U(5)<0)
       dUdt(22) = (1/m)*(A*(d(4) - U(5) + U(4))^(3/2) - 0 + m*g);
       end
       if (d(4) - U(5) + U(4)<0) && (d(5) - U(6) + U(5)<0)
       dUdt(22) = (1/m)*(0 - 0 + m*g);
       end
       
dUdt(23) = (1/m)*(A*(d(5) - U(6) + U(5))^(3/2) - A*(d(6) - U(7) + U(6))^(3/2) + m*g);

       if (d(5) - U(6) + U(5)<0) && (d(6) - U(7) + U(6)>0)
       dUdt(23) = (1/m)*(0 - A*(d(6) - U(7) + U(6))^(3/2) + m*g);
       end
       if (d(5) - U(6) + U(5)>0) && (d(6) - U(7) + U(6)<0)
       dUdt(23) = (1/m)*(A*(d(5) - U(6) + U(5))^(3/2) - 0 + m*g);
       end
       if (d(5) - U(6) + U(5)<0) && (d(6) - U(7) + U(6)<0)
       dUdt(23) = (1/m)*(0 - 0 + m*g);
       end

dUdt(24) = (1/m)*(A*(d(6) - U(7) + U(6))^(3/2) - A*(d(7) - U(8) + U(7))^(3/2) + m*g);

       if (d(6) - U(7) + U(6)<0) && (d(7) - U(8) + U(7)>0)
       dUdt(24) = (1/m)*(0 - A*(d(7) - U(8) + U(7))^(3/2) + m*g);
       end
       if (d(6) - U(7) + U(6)>0) && (d(7) - U(8) + U(7)<0)
       dUdt(24) = (1/m)*(A*(d(6) - U(7) + U(6))^(3/2) - 0 + m*g);
       end
       if (d(6) - U(7) + U(6)<0) && (d(7) - U(8) + U(7)<0)
       dUdt(24) = (1/m)*(0 - 0 + m*g);
       end       

dUdt(25) = (1/m)*(A*(d(7) - U(8) + U(7))^(3/2) - A*(d(8) - U(9) + U(8))^(3/2) + m*g);

       if (d(7) - U(8) + U(7)<0) && (d(8) - U(9) + U(8)>0)
       dUdt(25) = (1/m)*(0 - A*(d(8) - U(9) + U(8))^(3/2) + m*g);
       end
       if (d(7) - U(8) + U(7)>0) && (d(8) - U(9) + U(8)<0)
       dUdt(25) = (1/m)*(A*(d(7) - U(8) + U(7))^(3/2) - 0 + m*g);
       end
       if (d(7) - U(8) + U(7)<0) && (d(8) - U(9) + U(8)<0)
       dUdt(25) = (1/m)*(0 - 0 + m*g);
       end                    
             
dUdt(26) = (1/ms)*(As*(d(8) - U(9) + U(8))^(3/2) - As*(d(9) - U(10) + U(9))^(3/2) + ms*g);

       if (d(8) - U(9) + U(8)<0) && (d(9) - U(10) + U(9)>0)
       dUdt(26) = (1/ms)*(0 - As*(d(9) - U(10) + U(9))^(3/2) + ms*g);
       end
       if (d(8) - U(9) + U(8)>0) && (d(9) - U(10) + U(9)<0)
       dUdt(26) = (1/ms)*(As*(d(8) - U(9) + U(8))^(3/2) - 0 + ms*g);
       end
       if (d(8) - U(9) + U(8)<0) && (d(9) - U(10) + U(9)<0)
       dUdt(26) = (1/ms)*(0 - 0 + ms*g);
       end              
    
dUdt(27) = (1/m)*(A*(d(9) - U(10) + U(9))^(3/2) - A*(d(10) - U(11) + U(10))^(3/2) + m*g);

       if (d(9) - U(10) + U(9)<0) && (d(10) - U(11) + U(10)>0)
       dUdt(27) = (1/m)*(0 - A*(d(10) - U(11) + U(10))^(3/2) + m*g);
       end
       if (d(9) - U(10) + U(9)>0) && (d(10) - U(11) + U(10)<0)
       dUdt(27) = (1/m)*(A*(d(9) - U(10) + U(9))^(3/2) - 0 + m*g);
       end
       if (d(9) - U(10) + U(9)<0) && (d(10) - U(11) + U(10)<0)
       dUdt(27) = (1/m)*(0 - 0 + m*g);
       end       
       
dUdt(28) = (1/m)*(A*(d(10) - U(11) + U(10))^(3/2) - A*(d(11) - U(12) + U(11))^(3/2) + m*g);

       if (d(10) - U(11) + U(10)<0) && (d(11) - U(12) + U(11)>0)
       dUdt(28) = (1/m)*(0 - A*(d(11) - U(12) + U(11))^(3/2) + m*g);
       end
       if (d(10) - U(11) + U(10)>0) && (d(11) - U(12) + U(11)<0)
       dUdt(28) = (1/m)*(A*(d(10) - U(11) + U(10))^(3/2) - 0 + m*g);
       end
       if (d(10) - U(11) + U(10)<0) && (d(11) - U(12) + U(11)<0)
       dUdt(28) = (1/m)*(0 - 0 + m*g);
       end 
       
dUdt(29) = (1/m)*(A*(d(11) - U(12) + U(11))^(3/2) - A*(d(12) - U(13) + U(12))^(3/2) + m*g);

       if (d(11) - U(12) + U(11)<0) && (d(12) - U(13) + U(12)>0)
       dUdt(29) = (1/m)*(0 - A*(d(12) - U(13) + U(12))^(3/2) + m*g);
       end
       if (d(11) - U(12) + U(11)>0) && (d(12) - U(13) + U(12)<0)
       dUdt(29) = (1/m)*(A*(d(11) - U(12) + U(11))^(3/2) - 0 + m*g);
       end
       if (d(11) - U(12) + U(11)<0) && (d(12) - U(13) + U(12)<0)
       dUdt(29) = (1/m)*(0 - 0 + m*g);
       end 
       
dUdt(30) = (1/m)*(A*(d(12) - U(13) + U(12))^(3/2) - A*(d(13) - U(14) + U(13))^(3/2) + m*g);

       if (d(12) - U(13) + U(12)<0) && (d(13) - U(14) + U(13)>0)
       dUdt(30) = (1/m)*(0 - A*(d(13) - U(14) + U(13))^(3/2) + m*g);
       end
       if (d(12) - U(13) + U(12)>0) && (d(13) - U(14) + U(13)<0)
       dUdt(30) = (1/m)*(A*(d(12) - U(13) + U(12))^(3/2) - 0 + m*g);
       end
       if (d(12) - U(13) + U(12)<0) && (d(13) - U(14) + U(13)<0)
       dUdt(30) = (1/m)*(0 - 0 + m*g);
       end
       
dUdt(31) = (1/m)*(A*(d(13) - U(14) + U(13))^(3/2) - A*(d(14) - U(15) + U(14))^(3/2) + m*g);

       if (d(13) - U(14) + U(13)<0) && (d(14) - U(15) + U(14)>0)
       dUdt(31) = (1/m)*(0 - A*(d(14) - U(15) + U(14))^(3/2) + m*g);
       end
       if (d(13) - U(14) + U(13)>0) && (d(14) - U(15) + U(14)<0)
       dUdt(31) = (1/m)*(A*(d(14) - U(15) + U(14))^(3/2) - 0 + m*g);
       end
       if (d(13) - U(14) + U(13)<0) && (d(14) - U(15) + U(14)<0)
       dUdt(31) = (1/m)*(0 - 0 + m*g);
       end
       
dUdt(32) = (1/m)*(A*(d(14) - U(15) + U(14))^(3/2) - A*(d(15) - U(16) + U(15))^(3/2) + m*g);

       if (d(14) - U(15) + U(14)<0) && (d(15) - U(16) + U(15)>0)
       dUdt(32) = (1/m)*(0 - A*(d(15) - U(16) + U(15))^(3/2) + m*g);
       end
       if (d(14) - U(15) + U(14)>0) && (d(15) - U(16) + U(15)<0)
       dUdt(32) = (1/m)*(A*(d(14) - U(15) + U(14))^(3/2) - 0 + m*g);
       end
       if (d(14) - U(15) + U(14)<0) && (d(15) - U(16) + U(15)<0)
       dUdt(32) = (1/m)*(0 - 0 + m*g);
       end
       
dUdt(33) = (1/m)*(A*(d(15) - U(16) + U(15))^(3/2) - A*(d(16) - U(17) + U(16))^(3/2) + m*g);

       if (d(15) - U(16) + U(15)<0) && (d(16) - U(17) + U(16)>0)
       dUdt(33) = (1/m)*(0 - A*(d(16) - U(17) + U(16))^(3/2) + m*g);
       end
       if (d(15) - U(16) + U(15)>0) && (d(16) - U(17) + U(16)<0)
       dUdt(33) = (1/m)*(A*(d(15) - U(16) + U(15))^(3/2) - 0 + m*g);
       end
       if (d(15) - U(16) + U(15)<0) && (d(16) - U(17) + U(16)<0)
       dUdt(33) = (1/m)*(0 - 0 + m*g);
       end
       
dUdt(34) = (1/m)*(A*(d(16) - U(17) + U(16))^(3/2) - k_factor*Aw*(d(17) + U(17))^(3/2) + m*g);

        if (d(16) - U(17) + U(16)<0) && (d(17) + U(17)>0)
           dUdt(34) = (1/m)*(0 - k_factor*Aw*(d(17) + U(17))^(3/2) + m*g);
        end
        if (d(16) - U(17) + U(16)>0) && (d(17) + U(17)<0)
           dUdt(34) = (1/m)*(A*(d(16) - U(17) + U(16))^(3/2) - 0+ m*g);
        end
        if (d(16) - U(17) + U(16)<0) && (d(17) + U(17)<0)
          dUdt(34) = (1/m)*(0  + 0+ m*g); 
        end
    
end